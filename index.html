<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shark Pro - Earn & Withdraw</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; background: #121212; color: white; padding: 20px; }
        .card { background: #1e1e1e; padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        #balance { font-size: 2.5em; color: #4CAF50; }
        button { background: #4CAF50; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; width: 100%; margin: 10px 0; font-size: 1.1em; }
        input, select { width: 90%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none; }
        .withdraw-section { display: none; background: #252525; padding: 15px; border-radius: 15px; }
    </style>
</head>
<body>

    <div class="card">
        <h2>የእርስዎ ሂሳብ</h2>
        <div id="balance">0.00 ETB</div>
        <button onclick="watchAd()">WATCH AD & EARN</button>
        <button onclick="showWithdraw()" style="background: #2196F3;">CASH OUT (ብር አውጣ)</button>
    </div>

    <div id="withdraw-area" class="withdraw-section">
        <h3>ብር ማውጫ ፎርም</h3>
        <select id="bank-name">
            <option value="Telebirr">Telebirr</option>
            <option value="CBE">CBE (ንግድ ባንክ)</option>
            <option value="Abyssinia">Bank of Abyssinia</option>
            <option value="Awash">Awash Bank</option>
        </select>
        <input type="text" id="acc-number" placeholder="የአካውንት ወይም ስልክ ቁጥር">
        <input type="number" id="amount" placeholder="የሚወጣው መጠን">
        <button onclick="submitWithdraw()" style="background: #f44336;">REQUEST WITHDRAW</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyC6bxJ1d3GwzsSYAQM6YCNIxzHOcvQAHx4",
            authDomain: "shark-pro-fire.firebaseapp.com",
            databaseURL: "https://shark-pro-fire-default-rtdb.firebaseio.com",
            projectId: "shark-pro-fire",
            storageBucket: "shark-pro-fire.firebasestorage.app",
            messagingSenderId: "997842284367",
            appId: "1:997842284367:web:d862eb126a2cc711151f3a"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const urlParams = new URLSearchParams(window.location.search);
        let userId = urlParams.get('user_id') || "user_" + Math.floor(Math.random() * 1000000);

        // ሂሳብ መጫን
        database.ref('users/' + userId).on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) document.getElementById('balance').innerText = data.balance.toFixed(2) + " ETB";
        });

        function watchAd() {
            let current = parseFloat(document.getElementById('balance').innerText);
            database.ref('users/' + userId).update({ balance: current + 0.50 });
            alert("0.50 ETB ተጨምሯል!");
        }

        function showWithdraw() {
            document.getElementById('withdraw-area').style.display = 'block';
        }

        function submitWithdraw() {
            let amount = parseFloat(document.getElementById('amount').value);
            let current = parseFloat(document.getElementById('balance').innerText);
            
            if (amount > current) {
                alert("በቂ ባላንስ የሎትም!");
            } else if (amount < 25) {
                alert("ዝቅተኛው የማውጫ መጠን 25 ETB ነው!");
            } else {
                database.ref('withdrawals').push({
                    userId: userId,
                    bank: document.getElementById('bank-name').value,
                    account: document.getElementById('acc-number').value,
                    amount: amount,
                    status: "Pending"
                });
                database.ref('users/' + userId).update({ balance: current - amount });
                alert("ጥያቄዎ ተልኳል! በ 24 ሰዓት ውስጥ ይከፈልዎታል።");
                document.getElementById('withdraw-area').style.display = 'none';
            }
        }
    </script>
</body>
</html>
